# Outlook LLM Rewriter Add-in

## Description

An Outlook add-in that uses a locally running Ollama instance to rewrite selected text within an email. This helps improve clarity, conciseness, or tone of your email content directly within Outlook.

## Features

-   Integrates with the Outlook ribbon (Message Read surface).
-   Allows users to select text in an email and request a rewrite.
-   Connects to a local Ollama service to perform the text generation.
-   Replaces the selected text with the rewritten version.
-   Provides user notifications for progress and errors.

## Getting Started

### Prerequisites

-   [Node.js](https://nodejs.org/) (version 18 or later recommended) and npm.
-   A running instance of [Ollama](https://ollama.com/) with the desired model(s) downloaded (e.g., `mistral`).
-   Microsoft Office connected to a Microsoft 365 subscription that supports Outlook Add-ins.

### Installation and Setup

1.  **Clone the repository (or ensure you are in the project directory):**
    ```bash
    # If you had cloned a repo, you'd cd into it. For this environment, files are already present.
    cd OutlookLlmRewriter 
    ```

2.  **Install dependencies:**
    This command installs all the necessary dependencies defined in `package.json`.
    ```bash
    npm install
    ```

3.  **Build the add-in:**
    This command compiles the TypeScript code and bundles assets.
    ```bash
    npm run build
    ```

4.  **Start the development server:**
    This command starts a local web server (usually on `https://localhost:3000`) to serve your add-in's static files (HTML, JS, CSS). The manifest file (`manifest.xml`) points to this server.
    ```bash
    npm start 
    # or sometimes: npm run dev-server
    ```
    Keep this server running while you are testing the add-in.

5.  **Sideload the add-in in Outlook:**
    *   Open Outlook (on the web, or desktop client).
    *   Go to "Get Add-ins" > "My add-ins".
    *   Under "Custom Addins", choose "Add a custom add-in" > "Add from file...".
    *   Upload the `manifest.xml` file located in the project's root directory (`OutlookLlmRewriter/manifest.xml`).
    *   Follow the prompts to install. The "Rewrite Selected Text" button should appear under an "LLM Tools" group in the Outlook ribbon.

## Ollama Configuration

This add-in requires a running instance of Ollama to function.

-   **API Endpoint**: The add-in is configured to connect to Ollama at `http://localhost:11434/api/generate`. If your Ollama instance is running on a different URL or port, you will need to modify the `OLLAMA_API_URL` constant in the `src/utils/ollamaApi.ts` file and rebuild the add-in (`npm run build`).
-   **Model**: By default, the add-in uses the `"mistral"` model. This is specified in the `rewriteTextWithOllama` function in `src/utils/ollamaApi.ts`. You can change this to any other model available in your Ollama instance by modifying the code and rebuilding.
-   **Ensure Ollama is Running**: Before using the add-in, make sure your Ollama application is running and the desired model (e.g., `mistral`) is downloaded and available. You can typically pull a model using `ollama pull mistral` in your terminal.

## Usage

1.  Open an email in Outlook.
2.  If composing a new email, type some text. If reading an email, you can use existing text.
3.  Select the portion of text you want to rewrite.
4.  Click on the "LLM Tools" tab in the Outlook ribbon (or find the group if the tab is shared).
5.  Click the "Rewrite Selected Text" button.
6.  You should see notifications indicating progress.
7.  If successful, the selected text will be replaced with the rewritten version from Ollama. If there's an error (e.g., Ollama not running, no text selected), a notification will inform you.

## Important Note on Testing Limitations

This add-in code was primarily developed and verified through static analysis and simulated testing due to limitations in the automated development environment that prevented a full `npm install` and `npm run build`. While the core logic is believed to be correct, it is crucial to **thoroughly test the add-in after sideloading it into your Outlook environment**. Please report any issues encountered.

## Contributing

Contributions are welcome! Please feel free to submit pull requests or open issues.

## License

This project is licensed under the MIT License. See the `LICENSE` file (if one exists in the project - typically generated by `yo office`) for details.
---

*This README was generated and enhanced as part of an automated development process.*
